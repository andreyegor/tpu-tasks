# Калькулятор - Реализация

## Архитектура

Проект реализован с использованием паттерна **MVC (Model-View-Controller)** и разделён на несколько пакетов для лучшей организации:

### Пакеты

#### 1. `lab.algebra` - Алгебраические операции
- **Operation** - интерфейс для математических операций
- **BinaryOperation** - абстрактный класс для бинарных операций (+, -, *, ^)
- **UnaryOperation** - абстрактный класс для унарных операций (√)
- **Addition, Subtraction, Multiplication, Power, SquareRoot** - конкретные реализации
- **OperationFactory** - фабрика для создания операций

**Особенности:**
- Операции имеют приоритеты (1: +/-, 2: *, 3: ^, 4: √)
- Поддерживается правильный порядок выполнения операций
- Унарные операторы имеют наивысший приоритет

#### 2. `lab.core` - Ядро калькулятора
- **Token** - базовый элемент выражения (число, оператор, скобка)
- **Tokenizer** - преобразует строку в список токенов
- **Expression** - хранит выражение как список токенов (не строка!)
- **ExpressionValidator** - проверяет корректность выражения
- **Calculator** - выполняет вычисления с использованием алгоритма Shunting-yard (преобразование в обратную польскую нотацию)

**Особенности:**
- Выражение хранится в удобном формате для вычислений (не просто строка)
- Валидация предотвращает ошибки вроде пропущенных операций
- Алгоритм Shunting-yard обеспечивает корректный порядок выполнения операций

#### 3. `lab.infra.controller` - Контроллер
- **CalculatorController** - управляет состоянием выражения
  - Добавление цифр, операторов, скобок
  - Удаление последнего элемента (backspace)
  - Вычисление выражения
  - Система наблюдателей (Observer pattern) для уведомления UI об изменениях

**Особенности:**
- Логика отделена от представления
- Промежуточный результат пересчитывается после каждого действия

#### 4. `lab.infra.view` - Представление (UI)
- **CalculatorView** - создаёт JavaFX интерфейс
  - Дисплей для отображения выражения и результата
  - Матрица кнопок (0-9, операторы, функции)
  - Обновляется при изменении состояния контроллера

## Функциональность

### Обязательные операции ✓
- ✓ Сложение (+)
- ✓ Вычитание (-)
- ✓ Умножение (*)
- ✓ Степень (^)
- ✓ Корень квадратный (√)
- ✓ Скобки ()

### Особенности
- ✓ Правильный порядок выполнения операций
- ✓ Промежуточный результат пересчитывается после каждого клика
- ✓ Ввод только мышкой
- ✓ Поддержка длинных выражений со скобками
- ✓ Валидация выражений с понятными сообщениями об ошибках

## Примеры использования

Приложение поддерживает:
- Простые вычисления: `5 + 3 * 2` = 11 (правильный порядок)
- Скобки: `(5 + 3) * 2` = 16
- Степени: `2 ^ 3 + 1` = 9
- Корни: `√16 + √9` = 7
- Сложные выражения: `(2 ^ 3 + 5) * 2 - √4` = 18

## Запуск

```bash
./gradlew run
```

## Сборка

```bash
./gradlew build
```
